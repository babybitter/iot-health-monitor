#!/bin/bash

# æ‚£è€…å¥åº·ç›‘æµ‹ç³»ç»Ÿ - ç”Ÿäº§ç¯å¢ƒå¯åŠ¨è„šæœ¬

echo "ğŸš€ å¯åŠ¨æ‚£è€…å¥åº·ç›‘æµ‹ç³»ç»Ÿç”Ÿäº§ç¯å¢ƒ..."

# æ£€æŸ¥EMQXæœåŠ¡
echo "æ£€æŸ¥EMQXæœåŠ¡çŠ¶æ€..."
sudo systemctl start emqx
sudo systemctl enable emqx

# æ£€æŸ¥ç«¯å£
echo "æ£€æŸ¥ç«¯å£çŠ¶æ€..."
sudo netstat -tlnp | grep -E "(1883|8083)"

# é…ç½®é˜²ç«å¢™
echo "é…ç½®é˜²ç«å¢™..."
sudo ufw allow 1883/tcp
sudo ufw allow 8083/tcp
sudo ufw --force enable

# æ˜¾ç¤ºç³»ç»Ÿä¿¡æ¯
echo "========================================"
echo "  æ‚£è€…å¥åº·ç›‘æµ‹ç³»ç»Ÿ - ç”Ÿäº§ç¯å¢ƒ"
echo "========================================"
echo "æœåŠ¡å™¨IP: 47.122.130.135"
echo "MQTTç«¯å£: 1883 (TCP)"
echo "WebSocketç«¯å£: 8083 (WS)"
echo "ç®¡ç†åå°: http://47.122.130.135:18083"
echo "ç”¨æˆ·å: test / å¯†ç : test123"
echo "========================================"
echo "ğŸ‰ ç”Ÿäº§ç¯å¢ƒå¯åŠ¨å®Œæˆï¼"